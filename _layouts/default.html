<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
    <meta name="description" content="{{ site.description }}">
    <link rel="stylesheet" href="{{ '/assets/css/book.css' | relative_url }}">
    {% seo %}
  </head>
  <body>
    <!-- Top Navigation Bar -->
    <nav class="top-nav">
      <div class="nav-container">
        <div class="nav-brand">
          <a href="{{ '/' | relative_url }}">{{ site.title }}</a>
        </div>
        <div class="nav-links">
          <a href="{{ site.github.repository_url }}" target="_blank">GitHub</a>
          <button class="nav-toggle" id="navToggle">☰ Chapters</button>
        </div>
      </div>
    </nav>

    <div class="book-container">
      <!-- Sidebar Navigation -->
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <h2>Chapters</h2>
          <button class="sidebar-close" id="sidebarClose">×</button>
        </div>
        <nav class="chapter-nav">
          {% for item in site.navigation %}
          <a href="{{ item.url | relative_url }}"
             class="chapter-link {% if page.url contains item.url %}active{% endif %}">
            {{ item.title }}
          </a>
          {% endfor %}
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <article class="book-content">
          {{ content }}

          {% if page.nav_order %}
            {% include page-nav.html %}
          {% endif %}
        </article>

        <footer class="page-footer">
          <p>{{ site.tagline }}</p>
          <p>Hosted on GitHub Pages</p>
        </footer>
      </main>
    </div>

    <!-- Overlay for mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <script>
      // Toggle sidebar on mobile
      const navToggle = document.getElementById('navToggle');
      const sidebar = document.getElementById('sidebar');
      const sidebarClose = document.getElementById('sidebarClose');
      const sidebarOverlay = document.getElementById('sidebarOverlay');

      function openSidebar() {
        sidebar.classList.add('open');
        sidebarOverlay.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function closeSidebar() {
        sidebar.classList.remove('open');
        sidebarOverlay.classList.remove('active');
        document.body.style.overflow = '';
      }

      navToggle.addEventListener('click', openSidebar);
      sidebarClose.addEventListener('click', closeSidebar);
      sidebarOverlay.addEventListener('click', closeSidebar);

      // Close sidebar when clicking a link on mobile
      const chapterLinks = document.querySelectorAll('.chapter-link');
      chapterLinks.forEach(link => {
        link.addEventListener('click', () => {
          if (window.innerWidth <= 768) {
            closeSidebar();
          }
        });
      });
    </script>
  </body>
</html>
